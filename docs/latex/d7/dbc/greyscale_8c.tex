\doxysection{lib/greyscale.c File Reference}
\hypertarget{greyscale_8c}{}\label{greyscale_8c}\index{lib/greyscale.c@{lib/greyscale.c}}


Unlocks greyscale on the calc at the cost of some cpu.  


{\ttfamily \#include "{}interupts.\+c"{}}\newline
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{greyscale_8c_a34ae1178623830a7a8b2c06ad82759be}\label{greyscale_8c_a34ae1178623830a7a8b2c06ad82759be} 
\#define {\bfseries \+\_\+\+LCD\+\_\+\+BUSY\+\_\+\+QUICK}~0x000B
\item 
\Hypertarget{greyscale_8c_a080021f8b22b47e0e515fadb3342b6d8}\label{greyscale_8c_a080021f8b22b47e0e515fadb3342b6d8} 
\#define {\bfseries \+\_\+\+\_\+hs}~\#
\begin{DoxyCompactList}\small\item\em Bypass allowing for \# in preprocess direcive values. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_acf4ad1993081b85bd9f163e75dd7317d}\label{greyscale_8c_acf4ad1993081b85bd9f163e75dd7317d} 
\#define {\bfseries WAIT\+\_\+\+LOC}~0x85\+BE
\begin{DoxyCompactList}\small\item\em Ram location for wait char. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a1b314ca85c938c9352de4512efffd642}\label{greyscale_8c_a1b314ca85c938c9352de4512efffd642} 
\#define {\bfseries CONTRAST\+\_\+\+LOC}~(\mbox{\hyperlink{greyscale_8c_acf4ad1993081b85bd9f163e75dd7317d}{WAIT\+\_\+\+LOC}}+1)
\begin{DoxyCompactList}\small\item\em Ram location for constast char. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a9f741cd56abeb0dc5e44623d691c2ec5}\label{greyscale_8c_a9f741cd56abeb0dc5e44623d691c2ec5} 
\#define {\bfseries GRAY\+\_\+\+CYCLE}~(\mbox{\hyperlink{greyscale_8c_a1b314ca85c938c9352de4512efffd642}{CONTRAST\+\_\+\+LOC}}+1)
\begin{DoxyCompactList}\small\item\em 0 -\/ 0x25, do not set this yourself \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_ad129d98e7f6db51ea51c8bd33a49d11d}\label{greyscale_8c_ad129d98e7f6db51ea51c8bd33a49d11d} 
\#define {\bfseries GRAY\+\_\+\+CYCLE\+\_\+\+CARRY}~(\mbox{\hyperlink{greyscale_8c_a9f741cd56abeb0dc5e44623d691c2ec5}{GRAY\+\_\+\+CYCLE}}+1)
\begin{DoxyCompactList}\small\item\em Used for greyscale math, do not set this yourself. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a9ba79c0c7ca01d04ac7e77b6c5c974a2}\label{greyscale_8c_a9ba79c0c7ca01d04ac7e77b6c5c974a2} 
\#define {\bfseries SAVE\+\_\+\+CONTRAST}~0x9\+D88
\begin{DoxyCompactList}\small\item\em Ram location of where the old contrast of the screen is stored. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a11168a5098e7692094b7b6879558ecc0}\label{greyscale_8c_a11168a5098e7692094b7b6879558ecc0} 
\#define {\bfseries DEFAULT\+\_\+\+MAX\+\_\+\+COL}~12
\begin{DoxyCompactList}\small\item\em Only used when setting the initial MAX\+\_\+\+COL. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_ad7ec6474c074831d2a3d774564337aad}\label{greyscale_8c_ad7ec6474c074831d2a3d774564337aad} 
\#define {\bfseries COL\+\_\+\+START\+\_\+\+CONST}~0x20
\begin{DoxyCompactList}\small\item\em Only used when setting the initial START\+\_\+\+COL. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a0999f61805fd5db8ec16a027c1db621c}\label{greyscale_8c_a0999f61805fd5db8ec16a027c1db621c} 
\#define {\bfseries ROW\+\_\+\+CONST}~0x80
\begin{DoxyCompactList}\small\item\em Only used when setting the initial START\+\_\+\+ROW. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a0997428a77d4eda7188f0dd77a006790}\label{greyscale_8c_a0997428a77d4eda7188f0dd77a006790} 
\#define {\bfseries ROW\+\_\+\+END\+\_\+\+CONST}~0x\+BF
\begin{DoxyCompactList}\small\item\em Only used when setting the initial END\+\_\+\+ROW. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a0312cb6d6cbc719075d4e5380c387ab3}\label{greyscale_8c_a0312cb6d6cbc719075d4e5380c387ab3} 
\#define {\bfseries XMAX}~96
\item 
\Hypertarget{greyscale_8c_a610d6ad95b18966b70b6845de2a9c56b}\label{greyscale_8c_a610d6ad95b18966b70b6845de2a9c56b} 
\#define {\bfseries YMAX}~64
\item 
\#define \mbox{\hyperlink{greyscale_8c_a533ad373350e15bbee92fb6f790d61a7}{INIT\+\_\+\+GREYSCALE}}()
\begin{DoxyCompactList}\small\item\em Call this to enable greyscale interupts, {\bfseries{change greyscale settings after calling this }} \end{DoxyCompactList}\item 
\#define \mbox{\hyperlink{greyscale_8c_a6d5b329250099a1d538bfdf4276597ab}{ADDED\+\_\+\+ON\+\_\+\+EXIT}}()
\item 
\Hypertarget{greyscale_8c_a7f3dfe21a0d5d00f6b5621f528dd35f5}\label{greyscale_8c_a7f3dfe21a0d5d00f6b5621f528dd35f5} 
\#define {\bfseries OVERIDE\+\_\+\+INTERUPTS}
\item 
\Hypertarget{greyscale_8c_a7ffe571311fc7a5598d17fe3bdb9e3d2}\label{greyscale_8c_a7ffe571311fc7a5598d17fe3bdb9e3d2} 
\#define {\bfseries DURING\+\_\+\+INTERUPT}()~\mbox{\hyperlink{greyscale_8c_abbebc026da0bcc62f8667548ed32aa9d}{grey\+\_\+interupt}}()
\end{DoxyCompactItemize}
\begin{Indent}\textbf{ Greyscale setting ram locations}\par
\begin{DoxyCompactItemize}
\item 
\Hypertarget{greyscale_8c_aef84164dbbbf950ffc5da7ffcaf7f91c}\label{greyscale_8c_aef84164dbbbf950ffc5da7ffcaf7f91c} 
\#define {\bfseries START\+\_\+\+ROW}~(\mbox{\hyperlink{greyscale_8c_ad129d98e7f6db51ea51c8bd33a49d11d}{GRAY\+\_\+\+CYCLE\+\_\+\+CARRY}}+1)
\begin{DoxyCompactList}\small\item\em Ram location whoose value starts at 0x80 and defines what row the greyscale starts at. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a5c6dc4004a28fea314f91ccc7bd7abe5}\label{greyscale_8c_a5c6dc4004a28fea314f91ccc7bd7abe5} 
\#define {\bfseries END\+\_\+\+ROW}~(\mbox{\hyperlink{greyscale_8c_aef84164dbbbf950ffc5da7ffcaf7f91c}{START\+\_\+\+ROW}}+1)
\begin{DoxyCompactList}\small\item\em Ram location whoose value starts at 0x\+BF and defines what row the greyscale ends at. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ IF YOU CHANGE COL, YOU MUST CHANGE THE XMAX, OTHERWISE THE IMAGE IS MESSED UP\+: \#define XMAX (endcol -\/ startcol)\texorpdfstring{$\ast$}{*}8}\par
\begin{DoxyCompactItemize}
\item 
\Hypertarget{greyscale_8c_a39d4b8bb4368e58868cad71db4842492}\label{greyscale_8c_a39d4b8bb4368e58868cad71db4842492} 
\#define {\bfseries START\+\_\+\+COL}~(\mbox{\hyperlink{greyscale_8c_a5c6dc4004a28fea314f91ccc7bd7abe5}{END\+\_\+\+ROW}}+1)
\begin{DoxyCompactList}\small\item\em Ram location of what colum the greyscale starts. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a97e80440b5a5ec2ffc172dead9f8d2ec}\label{greyscale_8c_a97e80440b5a5ec2ffc172dead9f8d2ec} 
\#define {\bfseries MAX\+\_\+\+COL}~(\mbox{\hyperlink{greyscale_8c_a39d4b8bb4368e58868cad71db4842492}{START\+\_\+\+COL}}+1)
\begin{DoxyCompactList}\small\item\em Ram location of how many colums to draw. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\begin{Indent}\textbf{ Grey scale screen buffer locations}\par
\begin{DoxyCompactItemize}
\item 
\Hypertarget{greyscale_8c_a422e7cd1a0055b8cac4e90ecafedb1bb}\label{greyscale_8c_a422e7cd1a0055b8cac4e90ecafedb1bb} 
\#define {\bfseries LIGHT\+\_\+\+GREY\+\_\+\+LOC}~plot\+SScreen
\begin{DoxyCompactList}\small\item\em Ram location of where light grey pixels are set. \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_a72ce1600877c91649360dc0786e98f09}\label{greyscale_8c_a72ce1600877c91649360dc0786e98f09} 
\#define {\bfseries DARK\+\_\+\+GREY\+\_\+\+LOC}~app\+Back\+Up\+Screen
\begin{DoxyCompactList}\small\item\em Ram location of where dark grey pixels are set. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{greyscale_8c_abbebc026da0bcc62f8667548ed32aa9d}\label{greyscale_8c_abbebc026da0bcc62f8667548ed32aa9d} 
void {\bfseries grey\+\_\+interupt} () \+\_\+\+\_\+naked
\begin{DoxyCompactList}\small\item\em Called during interupts, {\bfseries{DO NOT CALL YOURSELF}} \end{DoxyCompactList}\item 
\Hypertarget{greyscale_8c_ac5082e0fa1de607c1f6d085366d02591}\label{greyscale_8c_ac5082e0fa1de607c1f6d085366d02591} 
void {\bfseries clear\+Grey\+Scale\+Buffer} ()
\begin{DoxyCompactList}\small\item\em Quickly clears both LIGHT\+\_\+\+GREY\+\_\+\+LOC and DARK\+\_\+\+GREY\+\_\+\+LOC. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Unlocks greyscale on the calc at the cost of some cpu. 

Warnings\+: This {\itshape may} take up 90\% of the cpu time and should be used with cpu turbo set\+Cpu\+Speed(3) Look at the example in examples/grey\+Scale Usage\+:

you might want to know that there is an emergency killswitch built in, if you press the on button it will stop the greyscale, but you can disable the killswitch with \#define DISABLE\+\_\+\+ON\+\_\+\+BUTTON\+\_\+\+KILL before you include this file

Greyscale uses interupts so no need for a swap (don\textquotesingle{}t even try to use swap) First put your image in LIGHT\+\_\+\+GREY\+\_\+\+LOC and DARK\+\_\+\+GREY\+\_\+\+LOC, since there is 4 different color options (off, light grey, dark grey, and black) you need need 2 bits per pixel (one in LIGHT\+\_\+\+GREY\+\_\+\+LOC and the other in DARK\+\_\+\+GREY\+\_\+\+LOC), both bits are set for black and both are zero for off Use clear\+Grey\+Scale\+Buffer to clear these two buffers quickly

Your first instruction should be \doxylink{greyscale_8c_ac5082e0fa1de607c1f6d085366d02591}{clear\+Grey\+Scale\+Buffer()} followed by \doxylink{greyscale_8c_a533ad373350e15bbee92fb6f790d61a7}{INIT\+\_\+\+GREYSCALE()}

Next you may need to set your drawing settings (since default values are set in INIT\+\_\+\+GREYSCALE) this can be done in C as follows\+: \texorpdfstring{$\ast$}{*}((char\texorpdfstring{$\ast$}{*})START\+\_\+\+ROW) = ROW\+\_\+\+CONST; \texorpdfstring{$\ast$}{*}((char\texorpdfstring{$\ast$}{*})START\+\_\+\+COL) = COL\+\_\+\+START\+\_\+\+CONST;

\texorpdfstring{$\ast$}{*}((char\texorpdfstring{$\ast$}{*})END\+\_\+\+ROW) = ROW\+\_\+\+END\+\_\+\+CONST; \texorpdfstring{$\ast$}{*}((char\texorpdfstring{$\ast$}{*})MAX\+\_\+\+COL) = DEFAULT\+\_\+\+MAX\+\_\+\+COL; // you must change your XMAX (or equivalent) along with your DEFAULT\+\_\+\+MAX\+\_\+\+COL, otherwise things tend to break

It is recommended to add/subtrace to/from the default values due to some of them being offseted values (the setting for row 0 is 0x80 and column 0 is 0x20)

Ps. The emulator dosn\textquotesingle{}t work with greyscale well

Also if you use an appvar for greyscale settings use the name "{}greycfg"{} and use this structor \mbox{[}0x69, WAIT\+\_\+\+TIME, CONTRAST, 0x69\mbox{]} 0x69 is for integrity checking (Im not immature at all lol) see the 2048 in examples/ 

\doxysubsection{Macro Definition Documentation}
\Hypertarget{greyscale_8c_a6d5b329250099a1d538bfdf4276597ab}\label{greyscale_8c_a6d5b329250099a1d538bfdf4276597ab} 
\index{greyscale.c@{greyscale.c}!ADDED\_ON\_EXIT@{ADDED\_ON\_EXIT}}
\index{ADDED\_ON\_EXIT@{ADDED\_ON\_EXIT}!greyscale.c@{greyscale.c}}
\doxysubsubsection{\texorpdfstring{ADDED\_ON\_EXIT}{ADDED\_ON\_EXIT}}
{\footnotesize\ttfamily \#define ADDED\+\_\+\+ON\+\_\+\+EXIT(\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \_\_asm\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ld\ a,\ (\mbox{\hyperlink{greyscale_8c_a9ba79c0c7ca01d04ac7e77b6c5c974a2}{SAVE\_CONTRAST}})\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ld\ (contrast),\ a\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ add\ a,\ \mbox{\hyperlink{greyscale_8c_a080021f8b22b47e0e515fadb3342b6d8}{\_\_hs}}\ 0xD8\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ out\ (0x10),\ a\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ ret\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \_\_endasm}

\end{DoxyCode}
\Hypertarget{greyscale_8c_a533ad373350e15bbee92fb6f790d61a7}\label{greyscale_8c_a533ad373350e15bbee92fb6f790d61a7} 
\index{greyscale.c@{greyscale.c}!INIT\_GREYSCALE@{INIT\_GREYSCALE}}
\index{INIT\_GREYSCALE@{INIT\_GREYSCALE}!greyscale.c@{greyscale.c}}
\doxysubsubsection{\texorpdfstring{INIT\_GREYSCALE}{INIT\_GREYSCALE}}
{\footnotesize\ttfamily \#define INIT\+\_\+\+GREYSCALE(\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

{\bfseries Value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_a9f741cd56abeb0dc5e44623d691c2ec5}{GRAY\_CYCLE}})\ =\ 0b01101101\ ;\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_a1b314ca85c938c9352de4512efffd642}{CONTRAST\_LOC}})\ =\ 0x15;\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_a9ba79c0c7ca01d04ac7e77b6c5c974a2}{SAVE\_CONTRAST}})\ =\ *((\textcolor{keywordtype}{char}*)contrast);\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)contrast)\ =\ 0;\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *(\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_acf4ad1993081b85bd9f163e75dd7317d}{WAIT\_LOC}}\ =\ 0x9F;\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_ad129d98e7f6db51ea51c8bd33a49d11d}{GRAY\_CYCLE\_CARRY}})\ =\ 1;\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_aef84164dbbbf950ffc5da7ffcaf7f91c}{START\_ROW}})\ =\ \mbox{\hyperlink{greyscale_8c_a0999f61805fd5db8ec16a027c1db621c}{ROW\_CONST}};\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_a39d4b8bb4368e58868cad71db4842492}{START\_COL}})\ =\ \mbox{\hyperlink{greyscale_8c_ad7ec6474c074831d2a3d774564337aad}{COL\_START\_CONST}};\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_a5c6dc4004a28fea314f91ccc7bd7abe5}{END\_ROW}})\ =\ \mbox{\hyperlink{greyscale_8c_a0997428a77d4eda7188f0dd77a006790}{ROW\_END\_CONST}};\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *((\textcolor{keywordtype}{char}*)\mbox{\hyperlink{greyscale_8c_a97e80440b5a5ec2ffc172dead9f8d2ec}{MAX\_COL}})\ =\ \mbox{\hyperlink{greyscale_8c_a11168a5098e7692094b7b6879558ecc0}{DEFAULT\_MAX\_COL}};\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ SET\_INTERUPTS();\ \_\_asm\(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ld\ \ a,\ \mbox{\hyperlink{greyscale_8c_a080021f8b22b47e0e515fadb3342b6d8}{\_\_hs}}\ 0x40\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ (0x33),\ a\ \ \ ;10922\ Hz\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ld\ \ a,\ \mbox{\hyperlink{greyscale_8c_a080021f8b22b47e0e515fadb3342b6d8}{\_\_hs}}\ 2\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ (0x34),\ \ \ \ \ a\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ld\ \ a,\ (\mbox{\hyperlink{greyscale_8c_acf4ad1993081b85bd9f163e75dd7317d}{WAIT\_LOC}})\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ out\ (0x35),\ a\ \(\backslash\)}
\DoxyCodeLine{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \_\_endasm}

\end{DoxyCode}


Call this to enable greyscale interupts, {\bfseries{change greyscale settings after calling this }} 

